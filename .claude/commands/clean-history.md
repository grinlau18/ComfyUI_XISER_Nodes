# 清理历史记录命令

智能清理对话历史记录，防止超出token限制。

## 用法
```
/clean-history [target_percent]
```

## 参数
- `target_percent` (可选): 目标token使用百分比，默认70%

## 功能
1. **分析对话内容**：识别重要信息和可清理内容
2. **智能清理策略**：
   - 优先保留：代码、文件引用、重要决策
   - 优先清理：闲聊、重复解释、早期非关键内容
3. **添加清理总结**：保持对话连贯性
4. **安全边界**：确保不会过度清理

## 清理策略
1. **重要性优先**：清理低重要性消息（重要性分数<0.3）
2. **时间优先**：清理早期非重要消息
3. **保留最近**：保留最近20%的消息
4. **关键保留**：至少保留最重要的5条消息

## 示例
```
/clean-history 60
```
将对话token使用量降低到最大限制的60%。

## 自动触发
当token使用量超过90%时，建议运行此命令。

## 注意事项
- 清理过程可逆（原始对话仍保留在历史中）
- 清理后会添加系统消息说明清理内容
- 重要工作内容会被优先保留